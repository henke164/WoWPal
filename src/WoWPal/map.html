<html>
<head>
    <style>
        html, body {
            padding: 0;
            margin: 0;
            overflow: hidden;
            background: #444;
        }

        #map {
            position: absolute;
            width: 100%;
        }

        #debug {
            position: absolute;
            top:0;
            left:0;
            color:red;
        }

        #arrow-wrapper .arrow {
            position:absolute;
            width: 10px;
            height: 10px;
        }
    </style>
</head>
<body>
    <div class="menu">

    </div>
    <img id="map" />
    <div id="arrow-wrapper">
        <img id="player1_arrow" class="arrow" src="/Images/arrow.png" />
    </div>
    <span id="debug" />

    <script>
        var map = document.getElementById("map");
        var debug = document.getElementById("debug");
        var arrows = [{
            x: 0,
            y: 0,
            element: document.getElementById('player1_arrow')
        }];

        function log(text) {

        }

        function setMapUrl(url) {
            map.setAttribute('src', url);
        }

        function setCharacterLocation(x, y) {
            arrows[0].x = parseFloat(x.replace(',', '.'));
            arrows[0].y = parseFloat(y.replace(',', '.'));
            debug.innerHTML = "x: " + x + ", y: " + y;


            for (var x = 0; x < arrows.length; x++) {
                var xPos = arrows[x].x * map.width;
                var yPos = arrows[x].y * map.height;
                arrows[x].element.style.left = (xPos - (arrows[x].element.width / 2)) + "px";
                arrows[x].element.style.top = (yPos - (arrows[x].element.width / 2)) + "px";
            }
        }
        
        map.addEventListener("mousedown", function (e) {
            e.preventDefault();
        });

        document.body.addEventListener("mousedown", function (e) {
            var x = e.clientX / map.width;
            var y = e.clientY / map.height;

            if (e.button === 0) {
                try {
                    characterController.onFaceCommand(x.toString(), y.toString());
                } catch (e) {

                }
            } else {
                try {
                    characterController.onMovementCommand(x.toString(), y.toString());
                } catch (e) {

                }

                console.log(x, y);
            }
        });
        
        document.addEventListener('contextmenu', event => event.preventDefault());
    </script>
</body>
</html>